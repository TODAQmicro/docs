---
title: Auth Element
description: TODAQMicro Elements Authorization element with paywall integration
pubDate: October 13, 2025
---
import Element from "../../../components/Element";

## Auth Element

The Auth Element provides a secure authentication interface for users to access paywall-protected content. Once authenticated, you receive a session token that can be used to make paywall requests.

<Element type="auth" theme="light" hash="adedc7a6-3a65-453a-a1a2-0f83a3e8da1a" client:load />
<script>{`
    (() => {
        document.addEventListener("authorized", async (event) => {
            const { session } = event.detail;
            
            console.log('User authenticated! Session:', session);

            // Now you can make paywall requests with the session
            // Only the amount is required - the system automatically determines
            // the payment type and destination from your account
            try {
                const response = await fetch('https://pay.m.todaq.net/v3/paywall', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Cookie': 'session_id='+session,
                    },
                    credentials: "include",
                    body: JSON.stringify({
                        amount: 25.00  // Amount in dollars
                    }),
                });

                if (response.ok) {
                    const data = await response.json();
                    console.log('Payment approved!', data);
                    
                    // Grant access to protected content
                    showProtectedContent();
                } else if (response.status === 408) {
                    console.log('Payment approval timeout');
                    showTimeoutMessage();
                } else {
                    console.error('Payment failed:', response.status);
                    showErrorMessage();
                }
            } catch (error) {
                console.error('ERROR making paywall request:', error);
            }
        });

        function showProtectedContent() {
            // Your code to display the protected content
            document.getElementById('protected-content').style.display = 'block';
        }

        function showTimeoutMessage() {
            alert('Payment approval timed out. Please try again.');
        }

        function showErrorMessage() {
            alert('Payment failed. Please try again.');
        }
    })();
`}</script>

## Basic Integration

Add the Auth Element to your page and listen for the `authorized` event:

```javascript
import { loadMicroPayments } from '@todaqmicro/payment-js';

// Initialize MicroPayments
const micro = await loadMicroPayments('YOUR_PUBLIC_SECRET');
const elements = micro.elements();

// Create the auth element
const authElement = await elements.create('auth', {
  theme: 'light',
});

// Mount the element
authElement.mount('#auth-container');

// Listen for successful authentication
document.addEventListener('authorized', async (event) => {
    const { session } = event.detail;
    console.log('User authenticated! Session:', session);
    
    // Make a paywall request with just the amount
    const response = await fetch('https://pay.m.todaq.net/v3/paywall', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Cookie': `session_id=${session}`
        },
        body: JSON.stringify({
            amount: 5.00  // Payment amount in dollars
        })
    });
    
    if (response.ok) {
        console.log('Payment approved!');
        // Grant access to your content
    } else if (response.status === 408) {
        console.log('Payment timeout - user did not approve in time');
    }
});
```

## Simplified Paywall API

The paywall endpoint now only requires the `amount` parameter. The system automatically:
- **Determines the payment type** from your available digital quantities
- **Sets the destination** to the authenticated user's twin account

This means you don't need to manage payment type hashes or destination URLs - just specify how much to charge!

